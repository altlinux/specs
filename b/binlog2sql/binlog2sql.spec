Name: binlog2sql
Version: 0.1
Release: alt1.1

Summary: Parse MySQL binlog to SQL

License: GPLv3.0
Group: Development/Python3
Url: https://github.com/danfengcao/binlog2sql

# Source-git: https://github.com/danfengcao/binlog2sql.git
Source: %name-%version.tar

BuildArch: noarch

BuildRequires(pre): rpm-build-intro >= 2.2.4
BuildRequires(pre): rpm-build-python3

# generated by epm restore --dry-run from binlog2sql/requirements.txt
%py3_use pymysql >= 0.7.11
#py3_use wheel >= 0.29.0
%py3_use mysql-replication >= 0.13

%add_python3_self_prov_path %buildroot%python3_sitelibdir/
%description
Parse MySQL binlog to SQL.

See https://www.percona.com/blog/2020/07/09/binlog2sql-binlog-to-raw-sql-conversion-and-point-in-time-recovery/

%prep
%setup

%build
subst "s@!/usr/bin/env python\$@!/usr/bin/env python3@" binlog2sql/*.py

%install
mkdir -p %buildroot%_bindir/
mkdir -p %buildroot%python3_sitelibdir/
cp -a binlog2sql %buildroot%python3_sitelibdir/
ln -s %python3_sitelibdir/binlog2sql/binlog2sql.py %buildroot%_bindir/%name

%files
%doc README.md example/
%_bindir/%name
%python3_sitelibdir/%name/

%changelog
* Sat Nov 12 2022 Daniel Zagaynov <kotopesutility@altlinux.org> 0.1-alt1.1
- NMU: used %%add_python3_self_prov_path macro to skip self-provides from dependencies.

* Sun Jan 24 2021 Vitaly Lipatov <lav@altlinux.ru> 0.1-alt1
- initial build for ALT Sisyphus
