Name: mod_throttle
Version: 3.1.2
Release: alt2

Summary: A module which implements the bandwidth and request throttling for Apache.
License: Apache
Group: System/Servers

URL: http://www.snert.com/Software/mod_throttle/
Source0: http://www.snert.com/Software/mod_throttle/mod_throttle312.tgz
Source1: mod_throttle.conf
Packager: Michael Shigorin <mike@altlinux.org>

%define ap_mod_doc  %_var/www/html/addon-modules
%define ap_mod_conf %_sysconfdir/httpd/conf/addon-modules
%define ap_lib_dir  %_libdir/apache

# Automatically added by buildreq on Wed Aug 15 2007
BuildRequires: apache-devel

%description
This Apache module is intended to reduce the load on your server & bandwidth 
generated by popular virtual hosts, directories, locations, or users according 
to some supported polices (see documentation) that decide when to delay or 
refuse requests. Also mod_throttle can track and throttle incoming connections 
by IP address or by authenticated remote user. 			

%prep
%setup -q

%build
%_sbindir/apxs -c -o %name.so %name.c

%install
mkdir -p %buildroot{%ap_lib_dir,%ap_mod_conf}
install -m755 %name.so %buildroot%ap_lib_dir
install -m644 %SOURCE1 %buildroot%ap_mod_conf

%post
ln -s %_docdir/%name-%version %ap_mod_doc/%name
%_sbindir/apxs -e -a -n throttle %name.so
%_sbindir/apachectl update

%preun
if [ $1 = 0 ]; then
%_sbindir/apxs -e -A -n throttle %name.so
fi

%postun
rm -f %ap_mod_doc/%name
%_sbindir/apachectl update

%files
%doc CHANGES.txt LICENSE.txt
%doc index.shtml Img
%ap_lib_dir/%name.so
%config(noreplace) %ap_mod_conf/%name.conf

%changelog
* Wed Aug 15 2007 Michael Shigorin <mike@altlinux.org> 3.1.2-alt2
- just rebuilt an orphan

* Fri Dec 20 2002 Oleg Prokopyev <riiki@altlinux.ru> 3.1.2-alt1
- build for Sisyphus.
